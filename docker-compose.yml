version: "3.8"
services:
    pushgateway:
        image: prom/pushgateway:latest
        container_name: pushgateway
        ports:
            - "9091:9091"
        restart: unless-stopped
    redis:
        image: redis:7-alpine
        container_name: redis
        ports:
            - "6379:6379"
        restart: unless-stopped

    prometheus:
        image: prom/prometheus:latest
        container_name: prometheus
        ports:
            - "9090:9090"
        volumes:
            - ./prometheus.yml:/etc/prometheus/prometheus.yml
            - prom_data:/prometheus
        command:
            - "--config.file=/etc/prometheus/prometheus.yml"
        restart: unless-stopped

    grafana:
        image: grafana/grafana:latest
        container_name: grafana
        ports:
            - "3000:3000"
        volumes:
            - grafana_data:/var/lib/grafana
        restart: unless-stopped
        environment:
            - GF_SECURITY_ADMIN_PASSWORD=admin
            - GF_SECURITY_ADMIN_USER=admin

volumes:
    prom_data:
    grafana_data:
